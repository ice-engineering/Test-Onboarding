{
	"$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
	"handler": "Microsoft.Azure.CreateUIDef",
	"version": "0.1.2-preview",
	"parameters": {
		"config": {
			"isWizard": true,
			"basics": {
				"description": "**Streamline Workbook Deployment**",
				"location": {
					"label": "Location",
					"toolTip": "Location for all resources",
					"resourceTypes": [
						"Microsoft.OperationalInsights"
					]
				}
			}
		},
		"steps": [{
			"name": "workBooks",
			"label": "Workbooks",
			"elements": [{
					"name": "textBlock1",
					"type": "Microsoft.Common.TextBlock",
					"visible": true,
					"options": {
						"text": "Please select which Workbooks you want to deply into your Azure Sentinel environment",
						"link": {
							"label": "Learn more",
							"uri": "https://www.microsoft.com"
						}
					}
				},
				{
					"name": "enableNativeWorkbooksKind",
					"type": "Microsoft.Common.DropDown",
					"label": "Select Native Workbooks to include in Deployment",
					"placeholder": "",
					"multiselect": true,
					"defaultValue": "o365",
					"toolTip": "Select the Workbooks that you would like to enable",
					"constraints": {
						"allowedValues": [{
								"label": "Azure Activity",
								"value": "AzureActivity"
							},
							{
								"label": "Azure AD Sign in And Audit Logs",
								"value": "AzureAuditActivityAndSignin"
							},
							{
								"label": "Exchange Online",
								"value": "ExchangeOnline"
							},
							{
								"label": "Insecure Protocols",
								"value": "InsecureProtocols"
							},
							{
								"label": "Investigation Insights",
								"value": "InvestigationInsights"
							},
							{
								"label": "Microsoft Cloud App Security - discovery logs",
								"value": "MicrosoftCloudAppSecurity"
							},
							{
								"label": "Microsoft Teams",
								"value": "MicrosoftTeams"
							},
							{
								"label": "Office 365",
								"value": "Office365"
							},
							{
								"label": "Security Alerts",
								"value": "AzureSentinelSecurityAlerts"
							},
							{
								"label": "Security Status",
								"value": "SecurityStatus"
							},
							{
								"label": "SharePoint & OneDrive",
								"value": "SharePointAndOneDrive"
							}
						],
						"required": true
					},
					"visible": true
				},
				{
					"name": "enableCustomWorkbooksKind",
					"type": "Microsoft.Common.DropDown",
					"label": "Select Custom Workbooks to include in Deployment",
					"placeholder": "",
					"multiselect": true,
					"defaultValue": "o365",
					"toolTip": "Select the Workbooks that you would like to enable",
					"constraints": {
						"allowedValues": [{
								"label": "iCE Reporting",
								"value": "iCEReporting"
							},
							{
								"label": "Brute Force Monitoring",
								"value": "bruteforcemonitoring"
							}
						],
						"required": true
					},
					"visible": true
				}
			]
		} ],
		"outputs": {
			"workspaceName": "[basics('workspaceName')]",
			"dailyQuota": "[basics('dailyQuota')]",
			"dataRetention": "[basics('dataRetention')]",
			"enableNativeWorkbooksKind": "[steps('workBooks').enableNativeWorkbooksKind]",
			"enableCustomWorkbooksKind": "[steps('workBooks').enableCustomWorkbooksKind]",
			"location": "[location()]",
			"rgName": "[basics('rgName')]"
		}
	}
}
